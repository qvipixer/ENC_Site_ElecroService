{

      #pragma code("user32.dll");  
       HWND FindWindow(char*,char*);  
       HWND GetForegroundWindow();  
       void ShowWindow(HWND,int);   
       ShowWindow(GetForegroundWindow(),6);   
       ShowWindow(FindWindow("Shell_TrayWnd",NULL), 5);  
}



----------------------------------------------------------------------------------------------------------------------------------------------------------

#include "apdefap.h"
 char* _main(char* lpszPictureName, char* lpszObjectName, char* lpszPropertyName)
{
long  value;
long V1, V2;
char text[100];
static long Colordefault = 4802889;
DWORD dwTitleColor      = CO_BLACK;
DWORD dwTextColor      = CO_YELLOW;


value = GetTagDWord("_STATE");

V1 = value & 0xf;
V2 = value & 0xf000;


    if (value & 0x1){
         sprintf(text, "Неиспарвость,");
         dwTitleColor = CO_RED;
         dwTextColor = CO_BLACK;
         if(value & 0x80 ) {
              strcat(text, "в работе");  
         } else {
              strcat(text, "остановлен"); 
         }
         strcat(text, ",\r\n");  
         if(value & 0x4000) {
               strcat(text, "давление не набрано");         
         } else if (value & 0x2000) {
              strcat(text, "ошибка ответа контактора");  
        }  else if (value & 0x8000) {
              strcat(text, "отсутсвует готовность");  
        }
    } else {
        if (value & 0x4) {
            sprintf(text, "Автоматическое управление");
             strcat(text, ",\r\n");  
            if ( value & 0x100) {
                 strcat(text, "Основной, ");  
            } else if ( value & 0x400) {
                strcat(text, "В резерве, ");  
            } else {
                strcat(text, "Не выбран, "); 
            }

           if ( value & 0x200) {
                strcat(text, "заблокирован");  
           } else if ( value & 0x10 ) {
                strcat(text, "в ожидании");  
           } else if ((value & 0x80)||(value & 0x20))  {
               strcat(text, "в работе");  
           }else {
              strcat(text, "остановлен"); 
           }
        } else if (value & 0x2)  {
              sprintf(text, "Местное управление");
               dwTitleColor = CO_YELLOW;
              dwTextColor = CO_DKBLUE;
              strcat(text, ",\r\n"); 
              if(value & 0x80)  {
                   strcat(text, "запущен в работу");
              } else {
                    strcat(text, "остановлен"); 
              }
        }
   }


SetPropWord(lpszPictureName, "Rectangle1", "BackColor",  dwTitleColor);
SetPropWord(lpszPictureName,lpszObjectName, "ForeColor",   dwTextColor);


    return text;
}

------------------------------------------------------------------------
//CO_RED
//CO_GREEN
//CO_BLUE
//CO_CYAN
//CO_YELLOW
//CO_MAGENTA
//CO_LTGRAY
//CO_BLACK
//CO_DKRED
//CO_DKGREEN
//CO_DKBLUE
//CO_DKCYAN
//CO_DKYELLOW
//CO_DKMAGENTA
//CO_DKGRAY
//CO_WHITE.



BOOL ModeVisible = FALSE; 
char *ModeText = "";




if( value & 0x20000) {
ModeVisible = TRUE;
ModeText = "A";
ModeColor = CO_DKGRAY;
}


SetPropBOOL(lpszPictureName,lpszObjectName,"ModeVisible",ModeVisible);	
SetPropChar(lpszPictureName,lpszObjectName,"ModeText",ModeText);	//Return-Type: BOOL 




